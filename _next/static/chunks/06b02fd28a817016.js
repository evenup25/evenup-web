(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,33525,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"warnOnce",{enumerable:!0,get:function(){return s}});let s=e=>{}},79474,(e,t,r)=>{"use strict";var s=e.r(71645).__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;r.c=function(e){return s.H.useMemoCache(e)}},932,(e,t,r)=>{"use strict";t.exports=e.r(79474)},53210,e=>{"use strict";var t=e.i(88715);let r=null,s=r=(0,t.createClient)("https://wrnepxzmmuzcsmjmadli.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6IndybmVweHptbXV6Y3Ntam1hZGxpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg0NjE0NTYsImV4cCI6MjA3NDAzNzQ1Nn0.NcrD3dr1bxmHzH81ThzGbXxlAnS5qBIAod618CvSSvs",{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0}});e.s(["supabase",0,s])},98183,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var s={assign:function(){return o},searchParamsToUrlQuery:function(){return a},urlQueryToSearchParams:function(){return i}};for(var l in s)Object.defineProperty(r,l,{enumerable:!0,get:s[l]});function a(e){let t={};for(let[r,s]of e.entries()){let e=t[r];void 0===e?t[r]=s:Array.isArray(e)?e.push(s):t[r]=[e,s]}return t}function n(e){return"string"==typeof e?e:("number"!=typeof e||isNaN(e))&&"boolean"!=typeof e?"":String(e)}function i(e){let t=new URLSearchParams;for(let[r,s]of Object.entries(e))if(Array.isArray(s))for(let e of s)t.append(r,n(e));else t.set(r,n(s));return t}function o(e,...t){for(let r of t){for(let t of r.keys())e.delete(t);for(let[t,s]of r.entries())e.append(t,s)}return e}},95057,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var s={formatUrl:function(){return i},formatWithValidation:function(){return c},urlObjectKeys:function(){return o}};for(var l in s)Object.defineProperty(r,l,{enumerable:!0,get:s[l]});let a=e.r(90809)._(e.r(98183)),n=/https?|ftp|gopher|file/;function i(e){let{auth:t,hostname:r}=e,s=e.protocol||"",l=e.pathname||"",i=e.hash||"",o=e.query||"",c=!1;t=t?encodeURIComponent(t).replace(/%3A/i,":")+"@":"",e.host?c=t+e.host:r&&(c=t+(~r.indexOf(":")?`[${r}]`:r),e.port&&(c+=":"+e.port)),o&&"object"==typeof o&&(o=String(a.urlQueryToSearchParams(o)));let d=e.search||o&&`?${o}`||"";return s&&!s.endsWith(":")&&(s+=":"),e.slashes||(!s||n.test(s))&&!1!==c?(c="//"+(c||""),l&&"/"!==l[0]&&(l="/"+l)):c||(c=""),i&&"#"!==i[0]&&(i="#"+i),d&&"?"!==d[0]&&(d="?"+d),l=l.replace(/[?#]/g,encodeURIComponent),d=d.replace("#","%23"),`${s}${c}${l}${d}${i}`}let o=["auth","hash","host","hostname","href","path","pathname","port","protocol","query","search","slashes"];function c(e){return i(e)}},18581,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"useMergedRef",{enumerable:!0,get:function(){return l}});let s=e.r(71645);function l(e,t){let r=(0,s.useRef)(null),l=(0,s.useRef)(null);return(0,s.useCallback)(s=>{if(null===s){let e=r.current;e&&(r.current=null,e());let t=l.current;t&&(l.current=null,t())}else e&&(r.current=a(e,s)),t&&(l.current=a(t,s))},[e,t])}function a(e,t){if("function"!=typeof e)return e.current=t,()=>{e.current=null};{let r=e(t);return"function"==typeof r?r:()=>e(null)}}("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},18967,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var s={DecodeError:function(){return b},MiddlewareNotFoundError:function(){return j},MissingStaticPage:function(){return _},NormalizeError:function(){return g},PageNotFoundError:function(){return y},SP:function(){return x},ST:function(){return h},WEB_VITALS:function(){return a},execOnce:function(){return n},getDisplayName:function(){return u},getLocationOrigin:function(){return c},getURL:function(){return d},isAbsoluteUrl:function(){return o},isResSent:function(){return m},loadGetInitialProps:function(){return f},normalizeRepeatedSlashes:function(){return p},stringifyError:function(){return N}};for(var l in s)Object.defineProperty(r,l,{enumerable:!0,get:s[l]});let a=["CLS","FCP","FID","INP","LCP","TTFB"];function n(e){let t,r=!1;return(...s)=>(r||(r=!0,t=e(...s)),t)}let i=/^[a-zA-Z][a-zA-Z\d+\-.]*?:/,o=e=>i.test(e);function c(){let{protocol:e,hostname:t,port:r}=window.location;return`${e}//${t}${r?":"+r:""}`}function d(){let{href:e}=window.location,t=c();return e.substring(t.length)}function u(e){return"string"==typeof e?e:e.displayName||e.name||"Unknown"}function m(e){return e.finished||e.headersSent}function p(e){let t=e.split("?");return t[0].replace(/\\/g,"/").replace(/\/\/+/g,"/")+(t[1]?`?${t.slice(1).join("?")}`:"")}async function f(e,t){let r=t.res||t.ctx&&t.ctx.res;if(!e.getInitialProps)return t.ctx&&t.Component?{pageProps:await f(t.Component,t.ctx)}:{};let s=await e.getInitialProps(t);if(r&&m(r))return s;if(!s)throw Object.defineProperty(Error(`"${u(e)}.getInitialProps()" should resolve to an object. But found "${s}" instead.`),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0});return s}let x="undefined"!=typeof performance,h=x&&["mark","measure","getEntriesByName"].every(e=>"function"==typeof performance[e]);class b extends Error{}class g extends Error{}class y extends Error{constructor(e){super(),this.code="ENOENT",this.name="PageNotFoundError",this.message=`Cannot find module for page: ${e}`}}class _ extends Error{constructor(e,t){super(),this.message=`Failed to load static file for page: ${e} ${t}`}}class j extends Error{constructor(){super(),this.code="ENOENT",this.message="Cannot find the middleware module"}}function N(e){return JSON.stringify({message:e.message,stack:e.stack})}},73668,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"isLocalURL",{enumerable:!0,get:function(){return a}});let s=e.r(18967),l=e.r(52817);function a(e){if(!(0,s.isAbsoluteUrl)(e))return!0;try{let t=(0,s.getLocationOrigin)(),r=new URL(e,t);return r.origin===t&&(0,l.hasBasePath)(r.pathname)}catch(e){return!1}}},84508,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"errorOnce",{enumerable:!0,get:function(){return s}});let s=e=>{}},22016,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var s={default:function(){return b},useLinkStatus:function(){return y}};for(var l in s)Object.defineProperty(r,l,{enumerable:!0,get:s[l]});let a=e.r(90809),n=e.r(43476),i=a._(e.r(71645)),o=e.r(95057),c=e.r(8372),d=e.r(18581),u=e.r(18967),m=e.r(5550);e.r(33525);let p=e.r(91949),f=e.r(73668),x=e.r(65165);function h(e){return"string"==typeof e?e:(0,o.formatUrl)(e)}function b(t){var r;let s,l,a,[o,b]=(0,i.useOptimistic)(p.IDLE_LINK_STATUS),y=(0,i.useRef)(null),{href:_,as:j,children:N,prefetch:v=null,passHref:S,replace:w,shallow:O,scroll:C,onClick:P,onMouseEnter:E,onTouchStart:R,legacyBehavior:T=!1,onNavigate:k,ref:I,unstable_dynamicOnHover:A,...U}=t;s=N,T&&("string"==typeof s||"number"==typeof s)&&(s=(0,n.jsx)("a",{children:s}));let L=i.default.useContext(c.AppRouterContext),M=!1!==v,$=!1!==v?null===(r=v)||"auto"===r?x.FetchStrategy.PPR:x.FetchStrategy.Full:x.FetchStrategy.PPR,{href:D,as:F}=i.default.useMemo(()=>{let e=h(_);return{href:e,as:j?h(j):e}},[_,j]);if(T){if(s?.$$typeof===Symbol.for("react.lazy"))throw Object.defineProperty(Error("`<Link legacyBehavior>` received a direct child that is either a Server Component, or JSX that was loaded with React.lazy(). This is not supported. Either remove legacyBehavior, or make the direct child a Client Component that renders the Link's `<a>` tag."),"__NEXT_ERROR_CODE",{value:"E863",enumerable:!1,configurable:!0});l=i.default.Children.only(s)}let z=T?l&&"object"==typeof l&&l.ref:I,q=i.default.useCallback(e=>(null!==L&&(y.current=(0,p.mountLinkInstance)(e,D,L,$,M,b)),()=>{y.current&&((0,p.unmountLinkForCurrentNavigation)(y.current),y.current=null),(0,p.unmountPrefetchableInstance)(e)}),[M,D,L,$,b]),B={ref:(0,d.useMergedRef)(q,z),onClick(t){T||"function"!=typeof P||P(t),T&&l.props&&"function"==typeof l.props.onClick&&l.props.onClick(t),!L||t.defaultPrevented||function(t,r,s,l,a,n,o){if("undefined"!=typeof window){let c,{nodeName:d}=t.currentTarget;if("A"===d.toUpperCase()&&((c=t.currentTarget.getAttribute("target"))&&"_self"!==c||t.metaKey||t.ctrlKey||t.shiftKey||t.altKey||t.nativeEvent&&2===t.nativeEvent.which)||t.currentTarget.hasAttribute("download"))return;if(!(0,f.isLocalURL)(r)){a&&(t.preventDefault(),location.replace(r));return}if(t.preventDefault(),o){let e=!1;if(o({preventDefault:()=>{e=!0}}),e)return}let{dispatchNavigateAction:u}=e.r(99781);i.default.startTransition(()=>{u(s||r,a?"replace":"push",n??!0,l.current)})}}(t,D,F,y,w,C,k)},onMouseEnter(e){T||"function"!=typeof E||E(e),T&&l.props&&"function"==typeof l.props.onMouseEnter&&l.props.onMouseEnter(e),L&&M&&(0,p.onNavigationIntent)(e.currentTarget,!0===A)},onTouchStart:function(e){T||"function"!=typeof R||R(e),T&&l.props&&"function"==typeof l.props.onTouchStart&&l.props.onTouchStart(e),L&&M&&(0,p.onNavigationIntent)(e.currentTarget,!0===A)}};return(0,u.isAbsoluteUrl)(F)?B.href=F:T&&!S&&("a"!==l.type||"href"in l.props)||(B.href=(0,m.addBasePath)(F)),a=T?i.default.cloneElement(l,B):(0,n.jsx)("a",{...U,...B,children:s}),(0,n.jsx)(g.Provider,{value:o,children:a})}e.r(84508);let g=(0,i.createContext)(p.IDLE_LINK_STATUS),y=()=>(0,i.useContext)(g);("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},18566,(e,t,r)=>{t.exports=e.r(76562)},89405,e=>{"use strict";let t=["viewer","admin","owner"],r={viewer:0,admin:1,owner:2};function s(e){return"string"==typeof e&&t.includes(e)}function l(e,t){return r[e]>=r[t]}e.s(["hasRequiredRole",()=>l,"isAdminRole",()=>s])},617,e=>{"use strict";var t=e.i(43476),r=e.i(932),s=e.i(22016),l=e.i(18566),a=e.i(71645),n=e.i(89405),i=e.i(53210);function o(e){return{...e,loading:!0,error:null}}let c=[{href:"/admin",label:"Dashboard"},{href:"/admin/logs",label:"Logs"},{href:"/admin/roles",label:"Roles"}];function d(e){let d,m,p,f,x,h,b,g,y,_,j,N,v,S,w,O,C,P,E,R=(0,r.c)(58),{children:T,pageTitle:k,pageDescription:I,requiredRole:A}=e,U=void 0===A?"viewer":A,L=(0,l.usePathname)(),{loading:M,error:$,session:D,role:F}=function(){let e,t,s,l,c,d=(0,r.c)(6);d[0]===Symbol.for("react.memo_cache_sentinel")?(e={loading:!0,error:null,session:null,role:null},d[0]=e):e=d[0];let[u,m]=(0,a.useState)(e);d[1]===Symbol.for("react.memo_cache_sentinel")?(t=async()=>{m(o);let{data:e,error:t}=await i.supabase.auth.getSession();if(t)return void m({loading:!1,error:t.message,session:null,role:null});let r=e.session;if(!r?.user?.id)return void m({loading:!1,error:null,session:null,role:null});let{data:s,error:l}=await i.supabase.from("admin_user_roles").select("role").eq("user_id",r.user.id).maybeSingle();l?m({loading:!1,error:l.message,session:r,role:null}):m({loading:!1,error:null,session:r,role:(0,n.isAdminRole)(s?.role)?s.role:null})},d[1]=t):t=d[1];let p=t;return d[2]===Symbol.for("react.memo_cache_sentinel")?(s=()=>{let e=!0;(async()=>{if(await p(),!e)return})();let{data:t}=i.supabase.auth.onAuthStateChange(()=>{p()});return()=>{e=!1,t.subscription.unsubscribe()}},l=[p],d[2]=s,d[3]=l):(s=d[2],l=d[3]),(0,a.useEffect)(s,l),d[4]!==u?(c={...u,refresh:p},d[4]=u,d[5]=c):c=d[5],c}(),[z,q]=(0,a.useState)(!1);e:{if(!F){d=!1;break e}d=(0,n.hasRequiredRole)(F,U)}let B=d;R[0]===Symbol.for("react.memo_cache_sentinel")?(m=async()=>{q(!0),await i.supabase.auth.signOut(),q(!1)},R[0]=m):m=R[0];let J=m;if(M){let e;return R[1]===Symbol.for("react.memo_cache_sentinel")?(e=(0,t.jsx)("main",{className:"min-h-screen bg-slate-50 p-6",children:(0,t.jsx)("div",{className:"mx-auto max-w-5xl rounded-2xl border border-slate-200 bg-white p-6 shadow-sm",children:(0,t.jsx)("p",{className:"text-sm text-slate-600",children:"Loading admin portal..."})})}),R[1]=e):e=R[1],e}if($){let e,r;return R[2]===Symbol.for("react.memo_cache_sentinel")?(e=(0,t.jsx)("h1",{className:"text-lg font-semibold text-red-900",children:"Admin access check failed"}),R[2]=e):e=R[2],R[3]!==$?(r=(0,t.jsx)("main",{className:"min-h-screen bg-slate-50 p-6",children:(0,t.jsxs)("div",{className:"mx-auto max-w-5xl rounded-2xl border border-red-200 bg-red-50 p-6",children:[e,(0,t.jsx)("p",{className:"mt-2 text-sm text-red-800",children:$})]})}),R[3]=$,R[4]=r):r=R[4],r}if(!D){let e;return R[5]===Symbol.for("react.memo_cache_sentinel")?(e=(0,t.jsx)(u,{}),R[5]=e):e=R[5],e}if(!F){let e,r,s;return R[6]===Symbol.for("react.memo_cache_sentinel")?(e=(0,t.jsx)("h1",{className:"text-lg font-semibold text-amber-950",children:"No admin role assigned"}),r=(0,t.jsx)("p",{className:"mt-2 text-sm text-amber-900",children:"Your account is signed in but does not have access to admin pages."}),R[6]=e,R[7]=r):(e=R[6],r=R[7]),R[8]!==D.user.id?(s=(0,t.jsx)("main",{className:"min-h-screen bg-slate-50 p-6",children:(0,t.jsxs)("div",{className:"mx-auto max-w-5xl rounded-2xl border border-amber-300 bg-amber-50 p-6",children:[e,r,(0,t.jsxs)("p",{className:"mt-1 break-all text-xs text-amber-800",children:["User ID: ",D.user.id]})]})}),R[8]=D.user.id,R[9]=s):s=R[9],s}if(!B){let e,r,s,l;return R[10]===Symbol.for("react.memo_cache_sentinel")?(e=(0,t.jsx)("h1",{className:"text-lg font-semibold text-amber-950",children:"Insufficient role"}),R[10]=e):e=R[10],R[11]!==U?(r=(0,t.jsx)("span",{className:"font-semibold",children:U}),R[11]=U,R[12]=r):r=R[12],R[13]!==F?(s=(0,t.jsx)("span",{className:"font-semibold",children:F}),R[13]=F,R[14]=s):s=R[14],R[15]!==r||R[16]!==s?(l=(0,t.jsx)("main",{className:"min-h-screen bg-slate-50 p-6",children:(0,t.jsxs)("div",{className:"mx-auto max-w-5xl rounded-2xl border border-amber-300 bg-amber-50 p-6",children:[e,(0,t.jsxs)("p",{className:"mt-2 text-sm text-amber-900",children:["This page requires ",r," access. Your role is ",s,"."]})]})}),R[15]=r,R[16]=s,R[17]=l):l=R[17],l}let K=D.user.user_metadata?.nickname??D.user.user_metadata?.name??D.user.user_metadata?.full_name??null,V=D.user.email??null;R[18]===Symbol.for("react.memo_cache_sentinel")?(p=(0,t.jsx)("p",{className:"text-xs uppercase tracking-wide text-slate-500",children:"EvenUp Admin"}),R[18]=p):p=R[18],R[19]!==k?(f=(0,t.jsx)("h1",{className:"text-2xl font-semibold text-slate-900",children:k}),R[19]=k,R[20]=f):f=R[20],R[21]!==I?(x=I?(0,t.jsx)("p",{className:"mt-1 text-sm text-slate-600",children:I}):null,R[21]=I,R[22]=x):x=R[22],R[23]!==f||R[24]!==x?(h=(0,t.jsxs)("div",{children:[p,f,x]}),R[23]=f,R[24]=x,R[25]=h):h=R[25];let X=K??"Admin User";R[26]!==X?(b=(0,t.jsx)("p",{className:"truncate text-xs font-medium text-slate-800",children:X}),R[26]=X,R[27]=b):b=R[27];let Y=V??D.user.id;R[28]!==Y?(g=(0,t.jsx)("p",{className:"truncate text-[11px] text-slate-600",children:Y}),R[28]=Y,R[29]=g):g=R[29],R[30]!==g||R[31]!==b?(y=(0,t.jsxs)("div",{className:"max-w-[260px] rounded-lg border border-slate-200 bg-slate-50 px-3 py-2 text-right",children:[b,g]}),R[30]=g,R[31]=b,R[32]=y):y=R[32],R[33]!==F?(_=(0,t.jsxs)("span",{className:"rounded-full bg-slate-100 px-3 py-1 text-xs font-medium text-slate-700",children:["role: ",F]}),R[33]=F,R[34]=_):_=R[34],R[35]===Symbol.for("react.memo_cache_sentinel")?(j=()=>void J(),R[35]=j):j=R[35];let W=z?"Signing out...":"Sign out";return R[36]!==z||R[37]!==W?(N=(0,t.jsx)("button",{type:"button",onClick:j,disabled:z,className:"rounded-lg border border-slate-300 px-3 py-2 text-sm text-slate-700 hover:bg-slate-100 disabled:cursor-not-allowed disabled:opacity-60",children:W}),R[36]=z,R[37]=W,R[38]=N):N=R[38],R[39]!==y||R[40]!==_||R[41]!==N?(v=(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[y,_,N]}),R[39]=y,R[40]=_,R[41]=N,R[42]=v):v=R[42],R[43]!==v||R[44]!==h?(S=(0,t.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[h,v]}),R[43]=v,R[44]=h,R[45]=S):S=R[45],R[46]!==L?(w=c.map(e=>{let r=L===e.href||"/admin"!==e.href&&L.startsWith(`${e.href}/`);return(0,t.jsx)(s.default,{href:e.href,className:`rounded-lg px-3 py-2 text-sm ${r?"bg-slate-900 text-white":"border border-slate-300 text-slate-700 hover:bg-slate-100"}`,children:e.label},e.href)}),R[46]=L,R[47]=w):w=R[47],R[48]!==w?(O=(0,t.jsx)("nav",{className:"mt-4 flex flex-wrap gap-2 border-t border-slate-200 pt-4",children:w}),R[48]=w,R[49]=O):O=R[49],R[50]!==S||R[51]!==O?(C=(0,t.jsxs)("header",{className:"rounded-2xl border border-slate-200 bg-white p-4 shadow-sm sm:p-6",children:[S,O]}),R[50]=S,R[51]=O,R[52]=C):C=R[52],R[53]!==T?(P=(0,t.jsx)("section",{className:"rounded-2xl border border-slate-200 bg-white p-4 shadow-sm sm:p-6",children:T}),R[53]=T,R[54]=P):P=R[54],R[55]!==C||R[56]!==P?(E=(0,t.jsx)("main",{className:"min-h-screen bg-slate-50 p-4 sm:p-6",children:(0,t.jsxs)("div",{className:"mx-auto max-w-7xl space-y-4",children:[C,P]})}),R[55]=C,R[56]=P,R[57]=E):E=R[57],E}function u(){let e,s,l,n,o,c,d,u=(0,r.c)(20),[m,p]=(0,a.useState)(""),[f,x]=(0,a.useState)(""),[h,b]=(0,a.useState)("email"),[g,y]=(0,a.useState)("idle"),[_,j]=(0,a.useState)("");u[0]!==m?(e=async e=>{e.preventDefault(),y("sending"),j("");let{error:t}=await i.supabase.auth.signInWithOtp({email:m.trim(),options:{shouldCreateUser:!1}});if(t){y("error"),j(t.message);return}y("sent"),b("otp"),j("OTP sent. Enter the code from your email.")},u[0]=m,u[1]=e):e=u[1];let N=e;u[2]!==m||u[3]!==f?(s=async e=>{e.preventDefault(),y("verifying"),j("");let{error:t}=await i.supabase.auth.verifyOtp({email:m.trim(),token:f.trim(),type:"email"});if(t){y("error"),j(t.message);return}y("verified"),j("OTP verified. Checking admin access...")},u[2]=m,u[3]=f,u[4]=s):s=u[4];let v=s;return u[5]===Symbol.for("react.memo_cache_sentinel")?(l=(0,t.jsx)("h1",{className:"text-xl font-semibold text-slate-900",children:"Admin sign in"}),u[5]=l):l=u[5],u[6]===Symbol.for("react.memo_cache_sentinel")?(n=(0,t.jsxs)("p",{className:"mt-2 text-sm text-slate-600",children:["Sign in with an account that has an entry in ",(0,t.jsx)("code",{children:"admin_user_roles"}),"."]}),u[6]=n):n=u[6],u[7]!==m||u[8]!==N||u[9]!==v||u[10]!==f||u[11]!==g||u[12]!==h?(o="email"===h?(0,t.jsxs)("form",{className:"mt-5 space-y-3",onSubmit:e=>void N(e),children:[(0,t.jsx)("label",{className:"block text-sm text-slate-700",htmlFor:"admin-email",children:"Email"}),(0,t.jsx)("input",{id:"admin-email",type:"email",required:!0,value:m,onChange:e=>p(e.target.value),placeholder:"you@evenup.in",className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm outline-none focus:border-slate-500"}),(0,t.jsx)("button",{type:"submit",disabled:"sending"===g,className:"w-full rounded-lg bg-slate-900 px-4 py-2 text-sm text-white hover:bg-slate-800 disabled:cursor-not-allowed disabled:opacity-70",children:"sending"===g?"Sending...":"Send OTP"})]}):(0,t.jsxs)("form",{className:"mt-5 space-y-3",onSubmit:e=>void v(e),children:[(0,t.jsx)("label",{className:"block text-sm text-slate-700",htmlFor:"admin-otp-email",children:"Email"}),(0,t.jsx)("input",{id:"admin-otp-email",type:"email",value:m,readOnly:!0,className:"w-full rounded-lg border border-slate-200 bg-slate-50 px-3 py-2 text-sm text-slate-700"}),(0,t.jsx)("label",{className:"block text-sm text-slate-700",htmlFor:"admin-otp-code",children:"OTP code"}),(0,t.jsx)("input",{id:"admin-otp-code",type:"text",inputMode:"numeric",autoComplete:"one-time-code",required:!0,value:f,onChange:e=>x(e.target.value),placeholder:"123456",className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm outline-none focus:border-slate-500"}),(0,t.jsx)("button",{type:"submit",disabled:"verifying"===g,className:"w-full rounded-lg bg-slate-900 px-4 py-2 text-sm text-white hover:bg-slate-800 disabled:cursor-not-allowed disabled:opacity-70",children:"verifying"===g?"Verifying...":"Verify OTP"}),(0,t.jsx)("button",{type:"button",onClick:()=>{b("email"),x(""),y("idle"),j("")},className:"w-full rounded-lg border border-slate-300 px-4 py-2 text-sm text-slate-700 hover:bg-slate-100",children:"Use different email"})]}),u[7]=m,u[8]=N,u[9]=v,u[10]=f,u[11]=g,u[12]=h,u[13]=o):o=u[13],u[14]!==_||u[15]!==g?(c=_?(0,t.jsx)("p",{className:`mt-3 text-sm ${"error"===g?"text-red-700":"text-emerald-700"}`,children:_}):null,u[14]=_,u[15]=g,u[16]=c):c=u[16],u[17]!==o||u[18]!==c?(d=(0,t.jsx)("main",{className:"min-h-screen bg-slate-50 p-6",children:(0,t.jsxs)("div",{className:"mx-auto max-w-md rounded-2xl border border-slate-200 bg-white p-6 shadow-sm",children:[l,n,o,c]})}),u[17]=o,u[18]=c,u[19]=d):d=u[19],d}e.s(["default",()=>d],617)},32076,e=>{"use strict";var t=e.i(43476),r=e.i(932),s=e.i(71645),l=e.i(53210),a=e.i(617);let n=["viewer","admin","owner"];function i(){let e,i,h,b,g,y,_,j,N,v,S,w,O,C,P,E,R,T,k,I,A,U,L,M,$,D,F,z,q,B,J,K,V,X,Y,W,Z,G,H,Q,ee,et=(0,r.c)(86);et[0]===Symbol.for("react.memo_cache_sentinel")?(e=[],et[0]=e):e=et[0];let[er,es]=(0,s.useState)(e);et[1]===Symbol.for("react.memo_cache_sentinel")?(i={},et[1]=i):i=et[1];let[el,ea]=(0,s.useState)(i),[en,ei]=(0,s.useState)(!0),[eo,ec]=(0,s.useState)(null),[ed,eu]=(0,s.useState)(null),[em,ep]=(0,s.useState)(""),[ef,ex]=(0,s.useState)("viewer"),[eh,eb]=(0,s.useState)(!1),[eg,ey]=(0,s.useState)(null),[e_,ej]=(0,s.useState)(null),[eN,ev]=(0,s.useState)("");et[2]===Symbol.for("react.memo_cache_sentinel")?(h=[],et[2]=h):h=et[2];let[eS,ew]=(0,s.useState)(h),[eO,eC]=(0,s.useState)(!1),[eP,eE]=(0,s.useState)(!1);et[3]===Symbol.for("react.memo_cache_sentinel")?(b={},et[3]=b):b=et[3];let[eR,eT]=(0,s.useState)(b);et[4]===Symbol.for("react.memo_cache_sentinel")?(g=async()=>{ei(!0),ec(null);let{data:e,error:t}=await l.supabase.from("admin_user_roles").select("user_id,role,created_at,updated_at").order("updated_at",{ascending:!1});if(t){ec(t.message),ei(!1);return}let r=(e??[]).filter(f);es(r),eT(r.reduce(p,{}));let s=r.map(m);if(0===s.length){ea({}),ei(!1);return}let{data:a,error:n}=await l.supabase.from("user_profiles").select("id,email,nickname,status,deleted_at,last_active_at").in("id",s);if(n){ec(n.message),ei(!1);return}ea((a??[]).reduce(u,{})),ei(!1)},et[4]=g):g=et[4];let ek=g;et[5]===Symbol.for("react.memo_cache_sentinel")?(y=()=>{let e=window.setTimeout(()=>{ek()},0);return()=>{window.clearTimeout(e)}},_=[ek],et[5]=y,et[6]=_):(y=et[5],_=et[6]),(0,s.useEffect)(y,_),et[7]!==eN?(j=()=>{let e=eN.trim();if(e.length<2)return;let t=!1,r=setTimeout(async()=>{eC(!0);let r=e.replaceAll(","," ").replaceAll("%",""),{data:s,error:a}=await l.supabase.from("user_profiles").select("id,email,nickname,status,deleted_at,last_active_at").or(`email.ilike.%${r}%,nickname.ilike.%${r}%`).limit(8);if(!t){if(a){ec(a.message),ew([]),eC(!1);return}ew(s??[]),eC(!1)}},300);return()=>{t=!0,clearTimeout(r)}},N=[eN],et[7]=eN,et[8]=j,et[9]=N):(j=et[8],N=et[9]),(0,s.useEffect)(j,N);let eI=er.length;et[10]!==er?(v=new Set(er.map(d)),et[10]=er,et[11]=v):v=et[11];let eA=v;if(et[12]!==eA||et[13]!==eS){let e;et[15]!==eA?(e=e=>!eA.has(e.id),et[15]=eA,et[16]=e):e=et[16],S=eS.filter(e),et[12]=eA,et[13]=eS,et[14]=S}else S=et[14];let eU=S;et[17]!==ef||et[18]!==em?(w=async()=>{let e=em.trim();if(!e)return void ec("User ID is required.");eb(!0),ec(null),eu(null);let{error:t}=await l.supabase.from("admin_user_roles").upsert({user_id:e,role:ef},{onConflict:"user_id"});if(t){ec(t.message),eb(!1);return}eu("Role saved successfully."),ep(""),ev(""),ew([]),eE(!1),eb(!1),await ek()},et[17]=ef,et[18]=em,et[19]=w):w=et[19];let eL=w;et[20]!==eR?(O=async e=>{let t=eR[e.user_id]??e.role;if(t===e.role)return;ey(e.user_id),ec(null),eu(null);let{error:r}=await l.supabase.from("admin_user_roles").update({role:t}).eq("user_id",e.user_id);if(r){ec(r.message),ey(null);return}eu(`Role updated to ${t}.`),ey(null),await ek()},et[20]=eR,et[21]=O):O=et[21];let eM=O;et[22]===Symbol.for("react.memo_cache_sentinel")?(C=async e=>{if(!window.confirm("Are you sure you want to revoke this user's admin access?"))return;ej(e),ec(null),eu(null);let{error:t}=await l.supabase.from("admin_user_roles").delete().eq("user_id",e);if(t){ec(t.message),ej(null);return}eu(`Role removed for ${e}.`),ej(null),await ek()},et[22]=C):C=et[22];let e$=C;et[23]===Symbol.for("react.memo_cache_sentinel")?(P=(0,t.jsx)("h2",{className:"text-base font-semibold text-slate-900",children:"Assign role"}),E=(0,t.jsx)("p",{className:"mt-1 text-sm text-slate-600",children:"Search users by email or nickname, then assign one of the admin roles."}),et[23]=P,et[24]=E):(P=et[23],E=et[24]),et[25]===Symbol.for("react.memo_cache_sentinel")?(R=(0,t.jsx)("span",{children:"User search"}),et[25]=R):R=et[25],et[26]===Symbol.for("react.memo_cache_sentinel")?(T=e=>{let t=e.target.value;ev(t),eE(t.trim().length>=2),t.trim().length<2&&(eC(!1),ew([]))},et[26]=T):T=et[26],et[27]!==eN?(k=()=>eE(eN.trim().length>=2),et[27]=eN,et[28]=k):k=et[28],et[29]!==k||et[30]!==eN?(I=(0,t.jsxs)("label",{className:"space-y-1 text-sm text-slate-700",children:[R,(0,t.jsx)("input",{type:"text",value:eN,onChange:T,onFocus:k,placeholder:"name or email",className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm"})]}),et[29]=k,et[30]=eN,et[31]=I):I=et[31],et[32]===Symbol.for("react.memo_cache_sentinel")?(A=(0,t.jsx)("span",{children:"Role"}),et[32]=A):A=et[32],et[33]===Symbol.for("react.memo_cache_sentinel")?(U=e=>ex(e.target.value),et[33]=U):U=et[33],et[34]===Symbol.for("react.memo_cache_sentinel")?(L=n.map(c),et[34]=L):L=et[34],et[35]!==ef?(M=(0,t.jsxs)("label",{className:"space-y-1 text-sm text-slate-700",children:[A,(0,t.jsx)("select",{value:ef,onChange:U,className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm",children:L})]}),et[35]=ef,et[36]=M):M=et[36],et[37]!==I||et[38]!==M?($=(0,t.jsxs)("div",{className:"mt-4 grid gap-3 sm:grid-cols-2",children:[I,M]}),et[37]=I,et[38]=M,et[39]=$):$=et[39],et[40]!==eP||et[41]!==eO||et[42]!==eN||et[43]!==eU?(D=eP&&eN.trim().length>=2?(0,t.jsx)("div",{className:"mt-3 rounded-lg border border-slate-200 bg-white p-2",children:eO?(0,t.jsx)("p",{className:"px-2 py-1 text-xs text-slate-500",children:"Searching users..."}):0===eU.length?(0,t.jsx)("p",{className:"px-2 py-1 text-xs text-slate-500",children:"No users found."}):(0,t.jsx)("ul",{className:"space-y-1",children:eU.map(e=>(0,t.jsx)("li",{children:(0,t.jsxs)("button",{type:"button",className:"w-full rounded-md px-2 py-2 text-left text-sm hover:bg-slate-100",onClick:()=>{ep(e.id),ev(e.email??e.nickname??e.id),eC(!1),ew([]),eE(!1)},children:[(0,t.jsx)("p",{className:"font-medium text-slate-800",children:e.email??e.nickname??"-"}),(0,t.jsx)("p",{className:"text-xs text-slate-500",children:e.id})]})},e.id))})}):null,et[40]=eP,et[41]=eO,et[42]=eN,et[43]=eU,et[44]=D):D=et[44],et[45]===Symbol.for("react.memo_cache_sentinel")?(F=(0,t.jsx)("span",{children:"User ID (UUID)"}),et[45]=F):F=et[45],et[46]===Symbol.for("react.memo_cache_sentinel")?(z=e=>ep(e.target.value),et[46]=z):z=et[46],et[47]!==em?(q=(0,t.jsxs)("label",{className:"mt-3 block space-y-1 text-sm text-slate-700",children:[F,(0,t.jsx)("input",{type:"text",value:em,onChange:z,placeholder:"00000000-0000-0000-0000-000000000000",className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm"})]}),et[47]=em,et[48]=q):q=et[48],et[49]!==eL?(B=()=>void eL(),et[49]=eL,et[50]=B):B=et[50];let eD=eh?"Saving...":"Save role";return et[51]!==eh||et[52]!==B||et[53]!==eD?(J=(0,t.jsx)("div",{className:"mt-3",children:(0,t.jsx)("button",{type:"button",onClick:B,disabled:eh,className:"rounded-lg bg-slate-900 px-4 py-2 text-sm text-white hover:bg-slate-800 disabled:cursor-not-allowed disabled:opacity-70",children:eD})}),et[51]=eh,et[52]=B,et[53]=eD,et[54]=J):J=et[54],et[55]!==$||et[56]!==D||et[57]!==q||et[58]!==J?(K=(0,t.jsxs)("div",{className:"rounded-xl border border-slate-200 bg-slate-50 p-4",children:[P,E,$,D,q,J]}),et[55]=$,et[56]=D,et[57]=q,et[58]=J,et[59]=K):K=et[59],et[60]!==eo?(V=eo?(0,t.jsx)("p",{className:"rounded-lg border border-red-200 bg-red-50 px-3 py-2 text-sm text-red-700",children:eo}):null,et[60]=eo,et[61]=V):V=et[61],et[62]!==ed?(X=ed?(0,t.jsx)("p",{className:"rounded-lg border border-emerald-200 bg-emerald-50 px-3 py-2 text-sm text-emerald-700",children:ed}):null,et[62]=ed,et[63]=X):X=et[63],et[64]===Symbol.for("react.memo_cache_sentinel")?(Y=(0,t.jsx)("h3",{className:"text-sm font-semibold text-slate-900",children:"Assigned roles"}),et[64]=Y):Y=et[64],et[65]!==eI?(W=(0,t.jsxs)("div",{className:"flex items-center justify-between border-b border-slate-200 px-4 py-3",children:[Y,(0,t.jsxs)("span",{className:"text-xs text-slate-500",children:[eI," assignments"]})]}),et[65]=eI,et[66]=W):W=et[66],et[67]===Symbol.for("react.memo_cache_sentinel")?(Z=(0,t.jsx)("thead",{className:"bg-slate-100 text-slate-700",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"px-3 py-2",children:"User"}),(0,t.jsx)("th",{className:"px-3 py-2",children:"Role"}),(0,t.jsx)("th",{className:"px-3 py-2",children:"Status"}),(0,t.jsx)("th",{className:"px-3 py-2",children:"Last active"}),(0,t.jsx)("th",{className:"px-3 py-2",children:"Updated"}),(0,t.jsx)("th",{className:"px-3 py-2",children:"Action"})]})}),et[67]=Z):Z=et[67],et[68]!==eM||et[69]!==en||et[70]!==el||et[71]!==e_||et[72]!==eR||et[73]!==er||et[74]!==eg?(G=en?(0,t.jsx)("tr",{children:(0,t.jsx)("td",{className:"px-3 py-3 text-slate-500",colSpan:6,children:"Loading roles..."})}):0===er.length?(0,t.jsx)("tr",{children:(0,t.jsx)("td",{className:"px-3 py-3 text-slate-500",colSpan:6,children:"No admin roles assigned yet."})}):er.map(e=>{let r=el[e.user_id];return(0,t.jsxs)("tr",{className:"border-t border-slate-200",children:[(0,t.jsxs)("td",{className:"px-3 py-2",children:[(0,t.jsx)("p",{className:"font-medium text-slate-800",children:r?.email??r?.nickname??"-"}),(0,t.jsx)("p",{className:"text-xs text-slate-500",children:e.user_id})]}),(0,t.jsx)("td",{className:"px-3 py-2",children:(0,t.jsx)(x,{role:e.role})}),(0,t.jsx)("td",{className:"px-3 py-2 text-slate-700",children:r?.status??"-"}),(0,t.jsx)("td",{className:"px-3 py-2 text-slate-700",children:r?.last_active_at?new Date(r.last_active_at).toLocaleString():"-"}),(0,t.jsx)("td",{className:"px-3 py-2 text-slate-700",children:new Date(e.updated_at).toLocaleString()}),(0,t.jsx)("td",{className:"px-3 py-2",children:(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,t.jsx)("select",{value:eR[e.user_id]??e.role,onChange:t=>{let r=t.target.value;eT(t=>({...t,[e.user_id]:r}))},className:"rounded-md border border-slate-300 px-2 py-1 text-xs text-slate-700",children:n.map(o)}),(0,t.jsx)("button",{type:"button",className:"rounded-md border border-slate-300 px-2 py-1 text-xs text-slate-700 hover:bg-slate-100 disabled:cursor-not-allowed disabled:opacity-60",disabled:eg===e.user_id||(eR[e.user_id]??e.role)===e.role,onClick:()=>void eM(e),children:eg===e.user_id?"Updating...":"Update"}),(0,t.jsx)("button",{type:"button",className:"rounded-md border border-red-200 px-2 py-1 text-xs text-red-700 hover:bg-red-50 disabled:cursor-not-allowed disabled:opacity-60",disabled:e_===e.user_id,onClick:()=>void e$(e.user_id),children:e_===e.user_id?"Revoking...":"Revoke"})]})})]},e.user_id)}),et[68]=eM,et[69]=en,et[70]=el,et[71]=e_,et[72]=eR,et[73]=er,et[74]=eg,et[75]=G):G=et[75],et[76]!==G?(H=(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"min-w-full text-left text-sm",children:[Z,(0,t.jsx)("tbody",{children:G})]})}),et[76]=G,et[77]=H):H=et[77],et[78]!==W||et[79]!==H?(Q=(0,t.jsxs)("div",{className:"rounded-xl border border-slate-200",children:[W,H]}),et[78]=W,et[79]=H,et[80]=Q):Q=et[80],et[81]!==K||et[82]!==V||et[83]!==X||et[84]!==Q?(ee=(0,t.jsx)(a.default,{pageTitle:"Role Management",pageDescription:"Assign who can access the admin portal.",requiredRole:"admin",children:(0,t.jsxs)("div",{className:"space-y-5",children:[K,V,X,Q]})}),et[81]=K,et[82]=V,et[83]=X,et[84]=Q,et[85]=ee):ee=et[85],ee}function o(e){return(0,t.jsx)("option",{value:e,children:e},e)}function c(e){return(0,t.jsx)("option",{value:e,children:e},e)}function d(e){return e.user_id}function u(e,t){return e[t.id]=t,e}function m(e){return e.user_id}function p(e,t){return e[t.user_id]=t.role,e}function f(e){return n.includes(e.role)}function x(e){let s,l=(0,r.c)(3),{role:a}=e;if("owner"===a){let e;return l[0]===Symbol.for("react.memo_cache_sentinel")?(e=(0,t.jsx)("span",{className:"rounded-md bg-violet-100 px-2 py-1 text-xs font-semibold text-violet-700",children:"owner"}),l[0]=e):e=l[0],e}if("admin"===a){let e;return l[1]===Symbol.for("react.memo_cache_sentinel")?(e=(0,t.jsx)("span",{className:"rounded-md bg-sky-100 px-2 py-1 text-xs font-semibold text-sky-700",children:"admin"}),l[1]=e):e=l[1],e}return l[2]===Symbol.for("react.memo_cache_sentinel")?(s=(0,t.jsx)("span",{className:"rounded-md bg-slate-100 px-2 py-1 text-xs font-semibold text-slate-700",children:"viewer"}),l[2]=s):s=l[2],s}e.s(["default",()=>i])}]);